    def process_pdf_text(name, work_id, pdf_path):
        # Open the PDF file
        with open(pdf_path, 'rb') as file:
            # Create a PDF reader object
            reader = PyPDF2.PdfFileReader(file)

            # Initialize variables for titles and texts
            titles = []
            texts = []

            # Extract the text from each page
            for page_num in range(reader.numPages):
                page = reader.getPage(page_num)
                text = page.extractText()

                # Split the text into lines
                lines = text.split('\n')

                # Process each line to identify titles and paragraphs
                title = None
                paragraph = ''
                for line in lines:
                    line = line.strip()

                    # Check if the line is a title
                    if line:
                        if title is None:
                            title = line
                        else:
                            # Save the previous title and paragraph
                            titles.append(title)
                            texts.append(paragraph)

                            # Reset the title and paragraph variables
                            title = line
                            paragraph = ''
                    else:
                        # Append the line to the current paragraph
                        paragraph += line + '\n'

                # Save the last title and paragraph
                titles.append(title)
                texts.append(paragraph)

        # Insert the extracted titles and texts into the database
        insert_data(name, work_id, titles, texts)

        # Display a success message
        messagebox.showinfo("Success", "Data uploaded successfully")

    def insert_data(name, work_id, titles, texts):
        # Define the connection string
        conn_str = "DRIVER={SQL Server};SERVER=REAL3AZEF;DATABASE=AIFormReader;Trusted_Connection=yes;STRINGIZE_MAXSIZE=0"

        try:
            # Open the connection
            with pyodbc.connect(conn_str) as conn:
                # Define the SQL query
                sql = 'INSERT INTO Forms (Name, ID, Title, Text, Title2, Text2, Title3, Text3, Title4, Text4, Title5, Text5, Title6, Text6) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)'

                # Execute the query with the name, work ID number, titles, and texts as parameters
                with conn.cursor() as cursor:
                    for i in range(min(len(titles), 6)):
                        title = titles[i]
                        text = texts[i]

                        # Truncate the text to the maximum length allowed by the Text column
                        max_text_length = 200000
                        if len(text) > max_text_length:
                            text = text[:max_text_length]

                        # Assign the title and text to the appropriate columns in the SQL query
                        params = [name, work_id]
                        for j in range(6):
                            if j == i:
                                params.extend([title, text])
                            else:
                                params.extend(['', ''])

                        # Execute the query with the parameters
                        cursor.execute(sql, params)
                        conn.commit()

            # Display a success message
            messagebox.showinfo("Success", "Data uploaded successfully")

        except pyodbc.Error as e:
            # Handle database errors
            messagebox.showerror("Database Error", str(e))
